#+title: org-insight

* 功能介绍
 * 提供python工具操纵org-table
   1) 读取org table内容，转换成python dataframe, 方便做数据分析
   2) dataframe内容可以生成org talbe, 方便查看数据
   3) 使用第三方python工具生成图标
   4) 文档，介绍org table和python dataframe以及可视化图表的基础知识

* 安装
进入org_insight目录，运行pip install .

* 如何使用
** python DatgFrame的数据展示在org table内

1. org_insight.my_table提供了函数toOrgTable，将python的dataframe的数据显示在org table里面
2. org table要有#+RESULTS: 交易明细表
3. src block要有#+name: 交易明细表, 和org table的#+RESULTS: 相同
4. python dataframe的数据可以来自任何地方，例子中读取自mongodb
5. src block的标记: #+begin_src python :results table :hlines yes

#+RESULTS: 交易明细表
|   代码 | 简称     |       日期 |  价格 | 股数 |  印花税 |   佣金 | 过户费 |   其他 |
|        |          |            |       |      |         |        |        |        |
|--------+----------+------------+-------+------+---------+--------+--------+--------|
| 601100 | 恒立液压 | 2025-03-07 | 93.34 | 2600 | -121.34 | -12.45 |  -2.42 | -13.13 |
| 601100 | 恒立液压 | 2025-03-07 | 93.98 | 1200 |  -56.40 |  -5.80 |  -1.13 |  -6.09 |
| 601100 | 恒立液压 | 2025-03-07 | 93.76 |  200 |   -9.38 |  -3.98 |  -0.19 |  -1.02 |
| 601100 | 恒立液压 | 2025-03-07 | 95.05 | 1000 |  -47.53 |  -4.89 |  -0.97 |  -5.13 |


#+name: 交易明细表
#+begin_src python :results table :hlines yes
  import pymongo
  from pixiu import mongo as m
  import org_insight.my_table as t
  import pandas as pd
  ds_db = m.connect('dataset')
  table = ds_db['交易明细']
  docs = table.find({}, {'_id': 0}).sort([('日期', pymongo.DESCENDING)]).limit(10)
  df1 = pd.DataFrame(list(docs)) 
  return t.toOrgTable(df1, showRowNum=20)
#+end_src

       
